/*! angular-magnificent - v0.1.0 - 2016-01-03
* https://github.com/pixeleur/angular-magnificent
* Copyright (c) 2016 Manuel Ramirez - Pixeleur; Licensed MIT */
"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="angular-magnificent"),function(a){"use strict";var b=a.module("angular-magnificent",[]);b.constant("defaults",{enabled:!0,interval:30,current:0,mouseMove:null}),b.directive("magnificent",["$window","$timeout","$interval",function(b,c,d){return{restrict:"E",transclude:!0,template:'<ul class="magnificent-slider"><li ng-repeat="slide in magnificent.slides track by $index"><img ng-src="{{slide.src}}" id="slide{{$index}}"  class="magnificent-loading magnificent-fadein magnificent-fadeout" ng-show="magnificent.current==$index" preload/></li></ul>',scope:{magnificent:"="},controller:["$scope","defaults",function(b,c){a.extend(c,b.magnificent.settings),b.magnificent.settings=c,b.interval=1e3*b.magnificent.settings.interval}],link:function(e,f,g){"undefined"!=typeof e.magnificent.mouseMove&&a.element(document.body).bind("mousemove",function(a){e.magnificent.mouseMove(a)}),a.element(b).bind("resize",function(){e.resize()}),e.$watch("magnificent.current",function(){c(function(){e.resize()},0)}),e.resize=function(){var c=b.innerWidth,d=b.innerHeight,f=document.getElementById("slide"+e.magnificent.current),g=a.element(f.parentNode),h=g.find("img"),i=f.naturalWidth,j=f.naturalHeight;0===i&&0===j&&(i=c,j=d);var k=e.getFitCss(c,d,i,j);h.css({width:k.width+"px",height:k.height+"px"}),h.css("left",c/2-k.width/2+"px"),h.css("top",d/2-k.height/2+"px")},e.getFitCss=function(a,b,c,d){var f;return c>a&&d>b?f=e.reduce(c,d,a,b):a>c&&b>d?f=e.increase(c,d,a,b):c>a&&b>d?f=e.increaseH(c,d,b):a>c&&d>b?f=e.increaseW(c,d,a):c===a&&d===b&&(f={W:a,H:b}),{width:f.W,height:f.H}},e.reduce=function(a,b,c,d){for(var e=!1;!e;)a--,b--,a===c&&(e=!0),b===d&&(e=!0);return{W:a,H:b}},e.reduceW=function h(h,a,b){for(var c=!1;!c;)h--,a--,c=h===b?!0:!1;return{W:h,H:a}},e.reduceH=function i(a,i,b){for(var c=!1;!c;)a--,i--,c=a===b?!0:!1;return{W:a,H:i}},e.increase=function(a,b,c,d){for(var e=!1;!e;)a++,b++,a>=c&&b>=d&&(e=!0);return{W:a,H:b}},e.increaseW=function j(j,a,b){for(var c=!1;!c;)j++,a++,c=j===b?!0:!1;return{W:j,H:a}},e.increaseH=function k(a,k,b){for(var c=!1;!c;)a++,k++,c=k===b?!0:!1;return{W:a,H:k}},e.hasClass=function(a,b){c(function(){return(" "+f.className+" ").indexOf(" "+b+" ")>-1})},d(function(){var a=document.getElementById("slide"+e.magnificent.current);e.magnificent.settings.enabled&&!e.hasClass(a,"magnificent-loading")&&(e.magnificent.current===e.magnificent.slides.length-1?e.magnificent.current=0:e.magnificent.current++)},e.interval,0),e.getPath=function(){var b,c,d,e=document.getElementsByTagName("script"),f="angular-magnificent.min.js";a.forEach(e,function(a,e){b=a,c=b.src.substring(b.src.length-f.length),c===f&&(d=e)}),b=e[d];var g=b.src;return g.replace(f,"angular-magnificent.min.css")},e.linkStyle=function(){var b=e.getPath(),c=!1,d=document.getElementsByTagName("head")[0];if(a.forEach(d.childNodes,function(a,d){a.src===b&&(c=!0)}),!c){var f=document.createElement("link");f.type="text/css",f.rel="stylesheet",f.href=b,d.appendChild(f)}},e.linkStyle()}}}]),b.factory("loader",function(){return function(b,c,d){a.element(new Image).bind("load",function(){c()}).bind("error",function(){d()}).attr("src",b)}}),b.directive("preload",["loader",function(a){return{restrict:"A",scope:!0,link:function(b,c,d){b.url=d.ngSrc,a(b.url,function(){d.$set("src",b.url),c.removeClass("magnificent-loading"),c.addClass("magnificent-slide")},function(){console.log("failed")})}}}])}(angular);